<mdl-header></mdl-header>
<div class="app-main">
  <content-header big-title="{{'MODULE.HEADER.VLAN.NORMAL' | translate}}">
    <a href="/">Mars Cloud</a>
    <span>•</span>
    <span>{{'MODULE.HEADER.VLAN.NORMAL' | translate}}</span>
  </content-header>
  <section class="app-body vlan-container" style="flex-direction: column">
    <div class="main__content">
      <mdl-tabs ng-model="tabSelected" options="tabs"
                class-list="main__content__device-detail-tabs"
                on-select="onTabChange($value)">
      </mdl-tabs>
      <section class="tab-content" ng-if="tabSelected.type == 'default'" style="display: flex;">
        <div class="mars-col-16 relative">
          <div style="position: relative; display: flex; height: 100%;">
            <div class="type-container">
              <!-- <mdl-radio style="display: none" ng-model="model.typeMode"
                        display-label='model.portDisplayLabel' 
                        on-click="changeDisplayType($value)"></mdl-radio> 
              <mdl-radio  style="display: none" ng-model="model.typeMode"
                        display-label='model.tableDisplayLabel' 
                        on-click="changeDisplayType($value)"></mdl-radio> -->
                <view-select type-model="model.typeMode"></view-select>
            </div>
            <div class="ports-container" ng-if="model.typeMode.label === 'port'">
              <div class="filter-container">
                <mdl-select ng-if="model.filterTypes.length > 0" ng-model="model.selectedFilterType" 
                            display-label="{options: model.filterTypes}" ng-change="changeFilterType($value)">
                </mdl-select>
                <mdl-select ng-if="model.filterTypes.length > 0" ng-model="model.selectedSubFilter"
                            display-label="{options: model.subFilterItems}" ng-change="changeDisplayPorts($value)"></mdl-select>
              </div>
              <div class="deivce-list">
                <div class="no-result" ng-if="model.vlanPortsList.length === 0" 
                    ng-bind="'MODULES.VLAN.TAB.DEFAULT.NO_DATA' | translate">
                </div>
                <div ng-if="model.vlanPortsList.length > 0">
                  <div class="vlan-segment" ng-repeat="vlan in model.vlanPortsList track by $index">
                     <ports-group group-id="{{'group-id-' + $index}}" ports-list="vlan.ports"></ports-group>
                  </div>
                </div>
              </div>
            </div>
            <div ng-if="model.typeMode.label === 'table'" style="margin-top: 56px;">
              <mdl-table actions-show="model.actionsShow"
                     row-click="onTableRowClick($event)"
                     provider="model.provider" api-ready="onApiReady($api)">
              </mdl-table>
            </div>
          </div>  
        </div>
      </section>
      <section class="tab-content" ng-if="tabSelected.type == 'edit'">
        <div class="vlan-table-field" >
            <div class="header">
                <div class="mode_type">
                    <mdl-radio ng-model="vlanModel.editType" name="editType" value="edit_vlan"
                               display-label="{id: 'check_1', label: '修改', name: 'editType', value: 'edit_vlan'}">
                    </mdl-radio>
                    <mdl-radio ng-model="vlanModel.editType" name="editType" value="add_vlan"
                               display-label="{id: 'check_2', label: '添加', name: 'editType', value: 'add_vlan'}">
                    </mdl-radio>
                </div>

                <div class="operation_group" ng-if="vlanModel.editType == 'edit_vlan'">
                    <div style="display: flex;align-items: center;width:270px;">
                        <mdl-select ng-model="vlanModel.selectedDevice" display-label="{options: vlanModel.devicesOptions}"></mdl-select>
                    </div>
                    <div>
                        <mar-button btn-text="'MODULES.VLAN.TAB.EDIT.EDIT_VLAN' | translate" btn-class="'btn-black btn-md'" btn-icon="'done'" btn-click="createVlan()" btn-disabled="!vlanModel.addedDevices.length"/>
                    </div>
                </div>

                <div class="operation_group" ng-if="vlanModel.editType == 'add_vlan'">
                    <div style="display: flex;align-items: center;width:270px;">
                        <mdl-select ng-model="vlanModel.addSelectedDevice" display-label="{options: model.devicesMapArr}"></mdl-select>
                        <mdl-button ng-click="addDevice(vlanModel.selectedDevice.value)" icon-name="add" disabled="addDeviceDisabled"></mdl-button>
                        <mdl-button ng-click="removeDevice(vlanModel.selectedDevice.value)" icon-name="remove" disabled="removeDeviceDisabled"></mdl-button>
                    </div>
                    <div style="display: flex;align-items: center;">
                        <mar-button btn-text="'MODULES.VLAN.TAB.EDIT.CREATE_VLAN' | translate" btn-class="'btn-black btn-md'" btn-icon="'done'" btn-click="createVlan()" btn-disabled="!vlanModel.addedDevices.length || !vlanModel.vlanInput || !vlanModel.nativeVlan"/>
                    </div>
                </div>
            </div>

            <div class="content" ng-if="vlanModel.editType == 'edit_vlan'">
                <div class="options">
                    <mdl-radio ng-model="vlanModel.editSelectedType" name="editSelectedType" value="vlan"
                               display-label="{id: 'check_1', label: '指定VLAN', name: 'editSelectedType', value: 'vlan'}">
                    </mdl-radio>
                    <mdl-select style="margin-left:10px;" disable="vlanModel.editSelectedType == 'port'" ng-model="vlanModel.selectedVlan" display-label="{options: vlanModel.vlanOptions}"></mdl-select>

                    <mdl-radio style="margin-left:30px;" ng-model="vlanModel.editSelectedType" name="editSelectedType" value="port"
                               display-label="{id: 'check_2', label: '指定端口', name: 'editSelectedType', value: 'port'}">
                    </mdl-radio>
                    <mdl-select style="margin-left:10px;" disable="vlanModel.editSelectedType == 'vlan'" ng-model="vlanModel.selectedPort" display-label="{options: vlanModel.portsOptions}"></mdl-select>
                </div>

                <mdl-table style="height: auto;" actions-show="vlanModel.actionsShow"
                           row-click="onVlanTableRowClick($event)"
                           provider="vlanModel.provider" api-ready="onVlanApiReady($api)">
                </mdl-table>
            </div>

            <div class="content" ng-if="vlanModel.editType == 'add_vlan'">
                <div class="options">
                    <span class="title">VLAN:</span><valid-input class="item-input" ng-model="vlanModel.vlanInput" v-require="true" v-regex="vlanInputRegex"></valid-input>
                    <span class="title">Mode:</span><mdl-select ng-model="vlanModel.selectedMode" display-label="{options: vlanModel.modeOptions}"></mdl-select>
                    <span class="title">本征VLAN:</span><valid-input class="item-input" ng-model="vlanModel.nativeVlan" v-require="true" v-regex="nativeVlanRegex" disable="vlanModel.selectedMode.value == 'access'"></valid-input>
                    <mdl-radio ng-model="vlanModel.tagType" name="tagType" value="edit_vlan" disable="vlanModel.selectedMode.value == 'access'"
                               display-label="{id: 'check_1', label: 'tag', name: 'tagType', value: 'tag'}">
                    </mdl-radio>
                    <mdl-radio ng-model="vlanModel.tagType" name="tagType" value="add_vlan" disable="vlanModel.selectedMode.value == 'access'"
                               display-label="{id: 'check_2', label: 'untag', name: 'tagType', value: 'untag'}">
                    </mdl-radio>
                </div>
                <div class="device" ng-repeat="device in vlanModel.addedDevices track by $index">
                    <div class="name">{{device.name}}:</div>
                    <ports-group group-id="{{'group-id-' + $index}}" ports-list="device.ports" ports-num-per-row="{{vlanModel.portsNumPerRow}}"></ports-group>
                    <div class="batch-ports">
                        <span ng-bind="'MODULES.VLAN.TAB.EDIT.BATCH_INPUT' | translate"></span><valid-input ng-model="batchPorts" ng-value="formatPortsToStr(device.ports)" v-require="true" v-regex="portsBatchRegex" v-name="ports" v-rpcid="device-ports-input" ng-change="batchChangePorts($index, batchPorts)"></valid-input>
                    </div>
                </div>
            </div>
        </div>

        <!--<ng-controller ng-controller="VlanEstablishController">-->
            <!--<wizard steps="steps" title="title" show-wizard="showWizard" next-step="" before-cancel="cancel(formData)" before-submit="submit(formData)"></wizard>-->
        <!--</ng-controller>-->
      </section>
    </div>
  </section>
</div>